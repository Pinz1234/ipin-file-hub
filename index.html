<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IPIN SCRIPT</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="bg-blobs" aria-hidden="true">
    <span class="blob b1"></span>
    <span class="blob b2"></span>
    <span class="blob b3"></span>
  </div>

  <div class="wrap">
    <header class="top">
      <div class="brand">
        <div class="kicker">‚ú® IPIN FILE HUB</div>
        <h1>IPIN SCRIPT</h1>
        <p>Kumpulan script gratis by IPIN ‚Äî klik download, gas. Join komunitas biar dapet update üî•</p>
      </div>

      <button class="theme" id="themeBtn" type="button" title="Mode gelap/terang">
        <span class="themeIcon" id="themeIcon">üåû</span>
        <span class="themeTrack"><span class="themeDot"></span></span>
      </button>
    </header>

    <section class="cta">
      <div class="ctaLeft">
        <div class="ctaTitle">Join dulu biar gak ketinggalan ‚ö°</div>
        <div class="ctaBtns">
          <a class="pillBtn" href="https://chat.whatsapp.com/LvA30WKiFgB0t5yFjFmWsz?mode=hqrc" target="_blank" rel="noopener">üí¨ Grup WA</a>
          <a class="pillBtn" href="https://whatsapp.com/channel/0029VbBKScNAInPfll7NHM0O" target="_blank" rel="noopener">üì¢ Channel WA</a>
          <a class="pillBtn" href="https://t.me/IPINSHOP" target="_blank" rel="noopener">üöÄ Telegram</a>
          <a class="pillBtn" href="https://youtube.com/@PinshopCik" target="_blank" rel="noopener">‚ñ∂Ô∏è YouTube</a>
        </div>
      </div>

      <div class="ctaRight">
        <div class="stat">
          <div class="statNum" id="totalDownloads">0</div>
          <div class="statLabel">total download (device)</div>
        </div>
        <div class="statHint">*Hitungan ini versi simpel (per HP/per browser). Nanti bisa dibikin global.</div>
      </div>
    </section>

    <div class="bar">
      <input id="q" class="search" placeholder="Cari script... (contoh: launcher, panel, bot, chat)" />
      <button class="miniBtn" id="openInfo" type="button">‚ÑπÔ∏è Info</button>
    </div>

    <main id="list" class="grid"></main>
    <div id="empty" class="empty" style="display:none;">Gak ketemu yang cocok üòõ</div>

    <footer class="foot">
      <span>¬© IPIN SCRIPT</span>
      <span class="dotSep">‚Ä¢</span>
      <span>Made with ü§ç</span>
    </footer>
  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="modalTop">
        <h3 id="mTitle">Info</h3>
        <button class="xBtn" id="mClose" type="button">‚úï</button>
      </div>
      <p id="mText">...</p>

      <div class="modalActions">
        <a class="btnGhost" id="mLink" target="_blank" rel="noopener" style="display:none;">Buka Link</a>
        <button class="btnMain" id="mOk" type="button">Oke</button>
      </div>
    </div>
  </div>

  <script src="data.js"></script>
  <script>
    // ===== Theme =====
    const root = document.documentElement;
    const themeBtn = document.getElementById("themeBtn");
    const themeIcon = document.getElementById("themeIcon");

    const saved = localStorage.getItem("ipin_theme") || "dark"; // default dark biar premium
    root.setAttribute("data-theme", saved);
    themeIcon.textContent = saved === "dark" ? "üåô" : "üåû";

    themeBtn.addEventListener("click", () => {
      const current = root.getAttribute("data-theme") || "light";
      const next = current === "dark" ? "light" : "dark";
      root.setAttribute("data-theme", next);
      localStorage.setItem("ipin_theme", next);
      themeIcon.textContent = next === "dark" ? "üåô" : "üåû";
    });

    // ===== Modal helper =====
    const overlay = document.getElementById("overlay");
    const mTitle = document.getElementById("mTitle");
    const mText = document.getElementById("mText");
    const mClose = document.getElementById("mClose");
    const mOk = document.getElementById("mOk");
    const mLink = document.getElementById("mLink");

    function openModal({ title, text, url }) {
      mTitle.textContent = title;
      mText.textContent = text;

      if (url) {
        mLink.style.display = "inline-flex";
        mLink.href = url;
      } else {
        mLink.style.display = "none";
        mLink.href = "#";
      }

      overlay.classList.add("show");
      overlay.setAttribute("aria-hidden", "false");
    }
    function closeModal() {
      overlay.classList.remove("show");
      overlay.setAttribute("aria-hidden", "true");
    }
    overlay.addEventListener("click", (e) => { if (e.target === overlay) closeModal(); });
    mClose.addEventListener("click", closeModal);
    mOk.addEventListener("click", closeModal);

    // tombol info
    document.getElementById("openInfo").addEventListener("click", () => {
      openModal({
        title: "IPIN SCRIPT",
        text: "Download script gratis di sini. Mau premium / request? join Telegram IPINSHOP. Jangan lupa join grup biar dapet update & bantuan.",
        url: "https://t.me/IPINSHOP"
      });
    });

    // popup berurutan (sekali per kunjungan)
    if (!sessionStorage.getItem("ipin_pop")) {
      sessionStorage.setItem("ipin_pop", "1");
      setTimeout(() => openModal({
        title: "SC Premium?",
        text: "Ingin beli sc MD,Bug,Dll yang bagus? Gas Pv Telegram IPINN üëá",
        url: "https://t.me/IPINSHOP"
      }), 800);

      setTimeout(() => openModal({
        title: "Komunitas Bot",
        text: "Gabung Komunitas WhatsApp Bot & Chat Bot! Diskusi + update bot gratis üî•",
        url: "https://chat.whatsapp.com/LvA30WKiFgB0t5yFjFmWsz?mode=hqrc"
      }), 2000);
    }

    // ===== Download count (simple: per device) =====
    const totalEl = document.getElementById("totalDownloads");
    function getTotal() {
      return Number(localStorage.getItem("ipin_total_dl") || 0);
    }
    function incTotal() {
      const n = getTotal() + 1;
      localStorage.setItem("ipin_total_dl", String(n));
      totalEl.textContent = n;
    }
    totalEl.textContent = getTotal();

    function getPer(link) {
      return Number(localStorage.getItem("ipin_dl_" + link) || 0);
    }
    function incPer(link) {
      const n = getPer(link) + 1;
      localStorage.setItem("ipin_dl_" + link, String(n));
      return n;
    }

    // ===== Render scripts =====
    const listEl = document.getElementById("list");
    const emptyEl = document.getElementById("empty");
    const qEl = document.getElementById("q");

    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function render(filter = "") {
      listEl.innerHTML = "";
      const f = filter.trim().toLowerCase();
      const items = (window.scripts || []).filter(sc => {
        const hay = (sc.name + " " + sc.desc).toLowerCase();
        return !f || hay.includes(f);
      });

      emptyEl.style.display = items.length ? "none" : "block";

      items.forEach((sc, i) => {
        const card = document.createElement("article");
        card.className = "card";
        card.style.animationDelay = (i * 0.05) + "s";

        const per = getPer(sc.link);

        card.innerHTML = `
          <div class="cardTop">
            <h2>${escapeHtml(sc.name)}</h2>
            <span class="badge">FREE</span>
          </div>
          <p>${escapeHtml(sc.desc)}</p>

          <div class="cardRow">
            <button class="btnMain" type="button">‚¨á Download</button>
            <div class="meta">Didownload: <b>${per}</b></div>
          </div>
        `;

        card.querySelector("button").addEventListener("click", () => {
          const n = incPer(sc.link);
          card.querySelector(".meta b").textContent = n;
          incTotal();
          window.location.href = sc.link;
        });

        listEl.appendChild(card);
      });
    }

    qEl.addEventListener("input", () => render(qEl.value));
    render();
  </script>
</body>
</html>